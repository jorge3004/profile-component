Object.defineProperty(exports,"t",{value:!0});var e=require("lit");function t(e,[t,n]){return t.toLowerCase()!==t?e[t]=Object.assign(Object.assign({},n),{attribute:t.replace(/[A-Z]/g,"-$&").toLowerCase()}):e[t]=n,e}function n(e){return"boolean"==typeof e?{type:Boolean}:Array.isArray(e)?{type:Array}:"object"==typeof e?{type:Object}:{}}const o=e=>{return o=e||{},Object.entries(o).reduce(((e,[o,r])=>t(e,[o,n(r)])),{});var o},r=e=>(e=>void 0!==e&&void 0!==e.props)(e)?(e.props||[]).reduce(((e,n)=>(Object.entries(n).forEach((n=>e=t(e,n))),e)),{}):o(null==e?void 0:e.defaults),i={};var c="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},u={},s={},d={};Object.defineProperty(d,"t",{value:!0}),d.shallowClone=void 0,d.shallowClone=function(e){return"object"!=typeof e||!e||e instanceof Date||e instanceof RegExp?e:Array.isArray(e)?[...e]:Object.assign({},e)};var f={};function a(e){if(!e.dispatchEvent||!e.requestUpdate)throw new Error("Element missing required functions (dispatchEvent/requestUpdate)");return e}Object.defineProperty(f,"t",{value:!0}),f.withWorkflow=f.withReducer=f.withState=f.decorate=f.asUpdateableLitElement=void 0,f.asUpdateableLitElement=a;const l="__registered_states";function v(e){const t=e;if(t[l])return t;const n=a(e),o=n.updated;return t[l]={index:0,count:0,states:[],reducers:[],workflows:[]},n.updated=e=>(t[l].index=0,o(e)),t}f.decorate=v,f.withState=function(e,t,n={}){const o=v(e),{index:r,count:i}=o[l];return r===i?(o[l].index++,o[l].count++,o[l].states.push(t),t):(o[l].index++,n.updateDefault&&o[l].states[r].inject(t.get()),o[l].states[r])},f.withReducer=function(e,t){const n=v(e),{index:o,count:r,reducers:i}=n[l];return o!==r||i[o-1]?n[l].reducers[o-1]:(n[l].reducers[o-1]=t,t)},f.withWorkflow=function(e,t){const n=v(e),{index:o,count:r,workflows:i}=n[l];return o!==r||i[o-1]?n[l].workflows[o-1]:(n[l].workflows[o-1]=t,t)};var b=c&&c.o||function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function c(e){try{s(o.next(e))}catch(e){i(e)}}function u(e){try{s(o.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,u)}s((o=o.apply(e,t||[])).next())}))};Object.defineProperty(s,"t",{value:!0}),s.useState=void 0;const p=d,y=f;s.useState=(e,t,n={})=>{let o=(0,p.shallowClone)(t);const r=[()=>b(void 0,void 0,void 0,(function*(){return e.requestUpdate(),yield e.updateComplete}))],i=e=>b(void 0,void 0,void 0,(function*(){if(o!==e){o=(0,p.shallowClone)(e);for(const e of r)yield e(o)}}));return(0,y.withState)(e,new class{set value(e){i(e)}get value(){return o}publish(e){i(e)}set(e){return b(this,void 0,void 0,(function*(){yield i(e)}))}subscribe(e){r.push(e)}inject(e){o=e}get(){return o}getState(){return o}},n)};var j={},O=c&&c.o||function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function c(e){try{s(o.next(e))}catch(e){i(e)}}function u(e){try{s(o.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,u)}s((o=o.apply(e,t||[])).next())}))};Object.defineProperty(j,"t",{value:!0}),j.useReducer=void 0;const _=s,g=f;j.useReducer=(e,t,n,o={})=>{const{get:r,set:i}=(0,_.useState)(e,n,o),c=[],u=(n,u)=>O(void 0,void 0,void 0,(function*(){const s=t(r());return s[n]&&(yield i(yield s[n](u)),c.forEach((e=>e(n,r()))),o.dispatchEvent&&e.dispatchEvent(new CustomEvent(n,{detail:r()}))),r()}));return(0,g.withReducer)(e,{get:r,subscribe:e=>c.push(e),when:(e,t)=>c.push(((n,o)=>n===e&&t(o))),set:u,dispatch:u})};var m={},w=c&&c.o||function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function c(e){try{s(o.next(e))}catch(e){i(e)}}function u(e){try{s(o.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,u)}s((o=o.apply(e,t||[])).next())}))};Object.defineProperty(m,"t",{value:!0}),m.useWorkflow=void 0;const h=u,x=f;m.useWorkflow=(e,t)=>{const n=Object.entries(t).reduce(((t,[n,{reducer:o,initialState:r}])=>(t[n]=(0,h.useReducer)(e,o,r),t)),{}),o={},r={},i=[],c=e=>(i.push({type:"projections",args:[e]}),n[e]?n[e].get():void 0);return(0,x.withWorkflow)(e,{addActivity:(e,t)=>w(void 0,void 0,void 0,(function*(){var r,c;i.push({type:"addActivity",args:[e,t]}),yield Promise.all(null!==(c=null===(r=o[e])||void 0===r?void 0:r.map((e=>e(t))))&&void 0!==c?c:[]);for(const o of Object.values(n))yield o.dispatch(e,t)})),addSideeffect:(e,t)=>{i.push({type:"addSideeffect",args:[e,t]}),o[e]=[...o[e]||[],t]},projections:c,addCompensation:(e,t)=>{i.push({type:"addCompensation",args:[e,t]}),r[e]=[...r[e]||[],t]},compensate:()=>w(void 0,void 0,void 0,(function*(){i.push({type:"compensate",args:[]});for(const[e,t]of Object.entries(r))for(const o of t)for(const t of Object.values(n))yield t.dispatch(e,o)})),after:(e,t,n)=>{i.push({type:"after",args:[e,t,n]});const o=()=>w(void 0,void 0,void 0,(function*(){i.some((e=>((e,t)=>{if(e.type!==t.type)return!1;for(let n=0;n<t.args.length;n++)if(e.args[n]!==t.args[n])return!1;return!0})(e,t)))||(new Date(Date.now())>e?yield n():setTimeout(o,100))}));o()},plan:e=>w(void 0,void 0,void 0,(function*(){for(const[n,o]of Object.entries(e))if(t[n]&&JSON.stringify(c(n))===JSON.stringify(t[n].initialState))return yield o();return e[""]?yield e[""]():Promise.resolve(null)})),history:()=>[...i]})},function(e){Object.defineProperty(e,"t",{value:!0}),e.useWorkflow=e.useReducer=e.useState=void 0;var t=s;Object.defineProperty(e,"useState",{enumerable:!0,get:function(){return t.useState}});var n=j;Object.defineProperty(e,"useReducer",{enumerable:!0,get:function(){return n.useReducer}});var o=m;Object.defineProperty(e,"useWorkflow",{enumerable:!0,get:function(){return o.useWorkflow}})}(u);var E={},M={},S={};function A(e){if(!e.dispatchEvent||!e.requestUpdate)throw new Error("Element missing required functions (dispatchEvent/requestUpdate)");return e}Object.defineProperty(S,"t",{value:!0}),S.withEffect=S.decorate=S.asUpdateableLitElement=void 0,S.asUpdateableLitElement=A;const P="__registered_effects";function q(e){const t=e;if(t[P])return t;const n=A(e),o=n.updated;return t[P]={index:0,count:0,effects:[]},n.updated=e=>(t[P].index=0,o(e)),t}S.decorate=q,S.withEffect=function(e,t){const n=q(e),{index:o,count:r}=n[P];return o===r?(n[P].index++,n[P].count++,n[P].effects.push(t),t):(n[P].index++,n[P].effects[o])},Object.defineProperty(M,"t",{value:!0}),M.useOnce=M.useEffect=void 0;const C=S;function k(e,t,n){const o=(0,C.withEffect)(e,{on:t,observe:["__initial__dirty"]});o.observe.some(((e,t)=>n[t]!==e))&&o.on(),o.observe=n}M.useEffect=k;M.useOnce=(e,t)=>k(e,t,[]),function(e){Object.defineProperty(e,"t",{value:!0}),e.useOnce=e.useEffect=void 0;var t=M;Object.defineProperty(e,"useEffect",{enumerable:!0,get:function(){return t.useEffect}}),Object.defineProperty(e,"useOnce",{enumerable:!0,get:function(){return t.useOnce}})}(E);exports.dispatch=(e,t,n,o)=>e.dispatchEvent(new CustomEvent(t.trim(),Object.assign(Object.assign({},o),{detail:n}))),exports.pureLit=(t,n,o)=>{if(i[t])return i[t];class c extends e.LitElement{constructor(){super(),this.content=e.html``,(e=>void 0!==e&&void 0!==e.defaults)(o)&&Object.entries(o.defaults).forEach((([e,t])=>{this[e]=t}))}static get properties(){return r(o)}static get styles(){return null==o?void 0:o.styles}async performUpdate(){return this.content=await Promise.resolve(n(this)).catch((t=>e.html`<slot name="error">${t}</slot>`)),super.performUpdate()}render(){return this.content}}customElements.define(t,c);const u=document.createElement(t);return i[t]=u,u},exports.useEffect=E.useEffect,exports.useOnce=E.useOnce,exports.useReducer=u.useReducer,exports.useState=u.useState,exports.useWorkflow=u.useWorkflow;
//# sourceMappingURL=index.js.map
