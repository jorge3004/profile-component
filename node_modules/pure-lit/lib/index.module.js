import{LitElement as e,html as t}from"lit";function n(e,[t,n]){return t.toLowerCase()!==t?e[t]=Object.assign(Object.assign({},n),{attribute:t.replace(/[A-Z]/g,"-$&").toLowerCase()}):e[t]=n,e}function o(e){return"boolean"==typeof e?{type:Boolean}:Array.isArray(e)?{type:Array}:"object"==typeof e?{type:Object}:{}}const r=e=>{return t=e||{},Object.entries(t).reduce(((e,[t,r])=>n(e,[t,o(r)])),{});var t},i=e=>(e=>void 0!==e&&void 0!==e.props)(e)?(e.props||[]).reduce(((e,t)=>(Object.entries(t).forEach((t=>e=n(e,t))),e)),{}):r(null==e?void 0:e.defaults),c={},u=(n,o,r)=>{if(c[n])return c[n];customElements.define(n,class extends e{constructor(){super(),this.content=t``,(e=>void 0!==e&&void 0!==e.defaults)(r)&&Object.entries(r.defaults).forEach((([e,t])=>{this[e]=t}))}static get properties(){return i(r)}static get styles(){return null==r?void 0:r.styles}async performUpdate(){return this.content=await Promise.resolve(o(this)).catch((e=>t`<slot name="error">${e}</slot>`)),super.performUpdate()}render(){return this.content}});const u=document.createElement(n);return c[n]=u,u};var s="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},d={},f={},a={};Object.defineProperty(a,"t",{value:!0}),a.shallowClone=void 0,a.shallowClone=function(e){return"object"!=typeof e||!e||e instanceof Date||e instanceof RegExp?e:Array.isArray(e)?[...e]:Object.assign({},e)};var l={};function v(e){if(!e.dispatchEvent||!e.requestUpdate)throw new Error("Element missing required functions (dispatchEvent/requestUpdate)");return e}Object.defineProperty(l,"t",{value:!0}),l.withWorkflow=l.withReducer=l.withState=l.decorate=l.asUpdateableLitElement=void 0,l.asUpdateableLitElement=v;const b="__registered_states";function y(e){const t=e;if(t[b])return t;const n=v(e),o=n.updated;return t[b]={index:0,count:0,states:[],reducers:[],workflows:[]},n.updated=e=>(t[b].index=0,o(e)),t}l.decorate=y,l.withState=function(e,t,n={}){const o=y(e),{index:r,count:i}=o[b];return r===i?(o[b].index++,o[b].count++,o[b].states.push(t),t):(o[b].index++,n.updateDefault&&o[b].states[r].inject(t.get()),o[b].states[r])},l.withReducer=function(e,t){const n=y(e),{index:o,count:r,reducers:i}=n[b];return o!==r||i[o-1]?n[b].reducers[o-1]:(n[b].reducers[o-1]=t,t)},l.withWorkflow=function(e,t){const n=y(e),{index:o,count:r,workflows:i}=n[b];return o!==r||i[o-1]?n[b].workflows[o-1]:(n[b].workflows[o-1]=t,t)};var p=s&&s.o||function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function c(e){try{s(o.next(e))}catch(e){i(e)}}function u(e){try{s(o.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,u)}s((o=o.apply(e,t||[])).next())}))};Object.defineProperty(f,"t",{value:!0}),f.useState=void 0;const j=a,O=l;f.useState=(e,t,n={})=>{let o=(0,j.shallowClone)(t);const r=[()=>p(void 0,void 0,void 0,(function*(){return e.requestUpdate(),yield e.updateComplete}))],i=e=>p(void 0,void 0,void 0,(function*(){if(o!==e){o=(0,j.shallowClone)(e);for(const e of r)yield e(o)}}));return(0,O.withState)(e,new class{set value(e){i(e)}get value(){return o}publish(e){i(e)}set(e){return p(this,void 0,void 0,(function*(){yield i(e)}))}subscribe(e){r.push(e)}inject(e){o=e}get(){return o}getState(){return o}},n)};var m={},g=s&&s.o||function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function c(e){try{s(o.next(e))}catch(e){i(e)}}function u(e){try{s(o.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,u)}s((o=o.apply(e,t||[])).next())}))};Object.defineProperty(m,"t",{value:!0}),m.useReducer=void 0;const _=f,w=l;m.useReducer=(e,t,n,o={})=>{const{get:r,set:i}=(0,_.useState)(e,n,o),c=[],u=(n,u)=>g(void 0,void 0,void 0,(function*(){const s=t(r());return s[n]&&(yield i(yield s[n](u)),c.forEach((e=>e(n,r()))),o.dispatchEvent&&e.dispatchEvent(new CustomEvent(n,{detail:r()}))),r()}));return(0,w.withReducer)(e,{get:r,subscribe:e=>c.push(e),when:(e,t)=>c.push(((n,o)=>n===e&&t(o))),set:u,dispatch:u})};var h={},E=s&&s.o||function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function c(e){try{s(o.next(e))}catch(e){i(e)}}function u(e){try{s(o.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,u)}s((o=o.apply(e,t||[])).next())}))};Object.defineProperty(h,"t",{value:!0}),h.useWorkflow=void 0;const x=d,M=l;h.useWorkflow=(e,t)=>{const n=Object.entries(t).reduce(((t,[n,{reducer:o,initialState:r}])=>(t[n]=(0,x.useReducer)(e,o,r),t)),{}),o={},r={},i=[],c=e=>(i.push({type:"projections",args:[e]}),n[e]?n[e].get():void 0);return(0,M.withWorkflow)(e,{addActivity:(e,t)=>E(void 0,void 0,void 0,(function*(){var r,c;i.push({type:"addActivity",args:[e,t]}),yield Promise.all(null!==(c=null===(r=o[e])||void 0===r?void 0:r.map((e=>e(t))))&&void 0!==c?c:[]);for(const o of Object.values(n))yield o.dispatch(e,t)})),addSideeffect:(e,t)=>{i.push({type:"addSideeffect",args:[e,t]}),o[e]=[...o[e]||[],t]},projections:c,addCompensation:(e,t)=>{i.push({type:"addCompensation",args:[e,t]}),r[e]=[...r[e]||[],t]},compensate:()=>E(void 0,void 0,void 0,(function*(){i.push({type:"compensate",args:[]});for(const[e,t]of Object.entries(r))for(const o of t)for(const t of Object.values(n))yield t.dispatch(e,o)})),after:(e,t,n)=>{i.push({type:"after",args:[e,t,n]});const o=()=>E(void 0,void 0,void 0,(function*(){i.some((e=>((e,t)=>{if(e.type!==t.type)return!1;for(let n=0;n<t.args.length;n++)if(e.args[n]!==t.args[n])return!1;return!0})(e,t)))||(new Date(Date.now())>e?yield n():setTimeout(o,100))}));o()},plan:e=>E(void 0,void 0,void 0,(function*(){for(const[n,o]of Object.entries(e))if(t[n]&&JSON.stringify(c(n))===JSON.stringify(t[n].initialState))return yield o();return e[""]?yield e[""]():Promise.resolve(null)})),history:()=>[...i]})},function(e){Object.defineProperty(e,"t",{value:!0}),e.useWorkflow=e.useReducer=e.useState=void 0;var t=f;Object.defineProperty(e,"useState",{enumerable:!0,get:function(){return t.useState}});var n=m;Object.defineProperty(e,"useReducer",{enumerable:!0,get:function(){return n.useReducer}});var o=h;Object.defineProperty(e,"useWorkflow",{enumerable:!0,get:function(){return o.useWorkflow}})}(d);var S={},A={},P={};function k(e){if(!e.dispatchEvent||!e.requestUpdate)throw new Error("Element missing required functions (dispatchEvent/requestUpdate)");return e}Object.defineProperty(P,"t",{value:!0}),P.withEffect=P.decorate=P.asUpdateableLitElement=void 0,P.asUpdateableLitElement=k;const q="__registered_effects";function C(e){const t=e;if(t[q])return t;const n=k(e),o=n.updated;return t[q]={index:0,count:0,effects:[]},n.updated=e=>(t[q].index=0,o(e)),t}P.decorate=C,P.withEffect=function(e,t){const n=C(e),{index:o,count:r}=n[q];return o===r?(n[q].index++,n[q].count++,n[q].effects.push(t),t):(n[q].index++,n[q].effects[o])},Object.defineProperty(A,"t",{value:!0}),A.useOnce=A.useEffect=void 0;const D=P;function R(e,t,n){const o=(0,D.withEffect)(e,{on:t,observe:["__initial__dirty"]});o.observe.some(((e,t)=>n[t]!==e))&&o.on(),o.observe=n}A.useEffect=R;A.useOnce=(e,t)=>R(e,t,[]),function(e){Object.defineProperty(e,"t",{value:!0}),e.useOnce=e.useEffect=void 0;var t=A;Object.defineProperty(e,"useEffect",{enumerable:!0,get:function(){return t.useEffect}}),Object.defineProperty(e,"useOnce",{enumerable:!0,get:function(){return t.useOnce}})}(S);const T=(e,t,n,o)=>e.dispatchEvent(new CustomEvent(t.trim(),Object.assign(Object.assign({},o),{detail:n})));var U=S.useEffect,J=S.useOnce,N=d.useReducer,W=d.useState,$=d.useWorkflow;export{T as dispatch,u as pureLit,U as useEffect,J as useOnce,N as useReducer,W as useState,$ as useWorkflow};
//# sourceMappingURL=index.module.js.map
